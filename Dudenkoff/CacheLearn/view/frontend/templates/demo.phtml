<?php
/**
 * @var \Dudenkoff\CacheLearn\Block\CacheDemo $block
 */
?>
<div class="cache-learn-demo">
    <style>
        .cache-learn-demo {
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .cache-learn-demo h1 {
            color: #333;
            border-bottom: 3px solid #1979c3;
            padding-bottom: 10px;
        }
        .cache-learn-demo h2 {
            color: #1979c3;
            margin-top: 30px;
        }
        .demo-card {
            background: #f8f9fa;
            border-left: 4px solid #1979c3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .demo-card h3 {
            margin-top: 0;
            color: #333;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
        }
        .api-link {
            display: inline-block;
            background: #1979c3;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 4px;
            margin: 5px;
            transition: background 0.3s;
        }
        .api-link:hover {
            background: #145a8a;
            color: white;
        }
        .info-box {
            background: #e3f2fd;
            border: 1px solid #1979c3;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        .success-box {
            background: #d4edda;
            border: 1px solid #28a745;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        .demo-result {
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
        .label {
            font-weight: bold;
            color: #666;
        }
        .value {
            color: #333;
            font-size: 16px;
        }
    </style>

    <h1>ðŸš€ Magento Cache Learning Module</h1>
    
    <div class="info-box">
        <strong>Welcome!</strong> This interactive module teaches you how to use caching in Magento 2.
        Try the API endpoints below and watch how cache improves performance!
    </div>

    <h2>ðŸ“Š Live Cache Demo</h2>
    
    <div class="demo-card">
        <h3>Current Time vs Cached Time</h3>
        <div class="demo-result">
            <div class="label">Current Time (Not Cached):</div>
            <div class="value"><?= $block->escapeHtml($block->getCurrentTime()) ?></div>
        </div>
        <div class="demo-result">
            <div class="label">Cached Time (Updates every 5 minutes):</div>
            <div class="value"><?= $block->escapeHtml($block->getCachedTime()) ?></div>
        </div>
        <p><strong>Notice:</strong> Current time changes on every refresh, but cached time stays the same until cache expires!</p>
    </div>

    <div class="demo-card">
        <h3>Expensive Calculation (Cached)</h3>
        <div class="demo-result">
            <div class="label">Result of 1,000,000 iterations:</div>
            <div class="value"><?= $block->escapeHtml($block->getExpensiveCalculation()) ?></div>
        </div>
        <p><strong>Without cache:</strong> This calculation takes noticeable time.<br>
        <strong>With cache:</strong> Result is instant! (cached for 10 minutes)</p>
    </div>

    <h2>ðŸ§ª Interactive API Examples</h2>

    <div class="demo-card">
        <h3>1. Simple String Cache</h3>
        <p>Demonstrates basic cache save/load with simple strings.</p>
        <a href="<?= $block->escapeUrl($block->getUrl('cachelearn/demo/simple')) ?>" 
           class="api-link" 
           target="_blank">
            Test Simple Cache â†’
        </a>
        <div class="code-block">
GET /cachelearn/demo/simple

First call: Cache miss - generates data (2s delay)
Subsequent calls: Cache hit - instant response!
Cache expires after 60 seconds
        </div>
    </div>

    <div class="demo-card">
        <h3>2. Complex Data Cache</h3>
        <p>Shows how to cache arrays and objects (serialization/deserialization).</p>
        <a href="<?= $block->escapeUrl($block->getUrl('cachelearn/demo/complex')) ?>" 
           class="api-link" 
           target="_blank">
            Test Complex Cache â†’
        </a>
        <div class="code-block">
GET /cachelearn/demo/complex

Simulates expensive database query or API call
First call: 2 second delay
Cached calls: Instant!
Cache expires after 5 minutes
        </div>
    </div>

    <div class="demo-card">
        <h3>3. Clear Cache</h3>
        <p>Demonstrates cache invalidation.</p>
        <a href="<?= $block->escapeUrl($block->getUrl('cachelearn/demo/clear')) ?>" 
           class="api-link" 
           target="_blank">
            Clear Demo Cache â†’
        </a>
        <div class="code-block">
GET /cachelearn/demo/clear

Removes specific cache entries
Forces regeneration on next request
Useful when data changes
        </div>
    </div>

    <h2>ðŸ’¡ Key Concepts</h2>

    <div class="success-box">
        <strong>âœ“ When to Use Cache:</strong>
        <ul>
            <li>Data that doesn't change frequently</li>
            <li>Expensive database queries</li>
            <li>API call results</li>
            <li>Complex calculations</li>
            <li>Configuration data</li>
        </ul>
    </div>

    <div class="warning-box">
        <strong>âš  When NOT to Use Cache:</strong>
        <ul>
            <li>Frequently changing data</li>
            <li>User-specific sensitive data</li>
            <li>Real-time information</li>
            <li>Simple operations (caching overhead not worth it)</li>
        </ul>
    </div>

    <h2>ðŸŽ“ Learning Path</h2>

    <div class="demo-card">
        <h3>Step 1: Understand the Code</h3>
        <p>Review these files in order:</p>
        <ol>
            <li><code>Model/Cache/Type/CustomCache.php</code> - Custom cache type definition</li>
            <li><code>Service/CacheService.php</code> - Cache operations with examples</li>
            <li><code>Controller/Demo/*.php</code> - Practical usage examples</li>
            <li><code>Block/CacheDemo.php</code> - Using cache in blocks</li>
        </ol>
    </div>

    <div class="demo-card">
        <h3>Step 2: Enable the Cache Type</h3>
        <div class="code-block">
# Check cache status
bin/magento cache:status

# Enable custom cache type
bin/magento cache:enable dudenkoff_custom_cache

# Or enable all caches
bin/magento cache:enable
        </div>
    </div>

    <div class="demo-card">
        <h3>Step 3: Test the Examples</h3>
        <ol>
            <li>Click the API links above</li>
            <li>Observe the response times</li>
            <li>Refresh to see cache hits</li>
            <li>Clear cache and see regeneration</li>
        </ol>
    </div>

    <div class="demo-card">
        <h3>Step 4: Manage Cache via CLI</h3>
        <div class="code-block">
# View all cache types
bin/magento cache:status

# Clean specific cache type
bin/magento cache:clean dudenkoff_custom_cache

# Flush all cache
bin/magento cache:flush

# Disable cache type
bin/magento cache:disable dudenkoff_custom_cache
        </div>
    </div>

    <h2>ðŸ“š Additional Resources</h2>
    
    <div class="info-box">
        <p><strong>See also:</strong></p>
        <ul>
            <li><code>README.md</code> - Complete documentation</li>
            <li><code>CACHE_TYPES.md</code> - Different cache types explained</li>
            <li><code>BEST_PRACTICES.md</code> - Caching patterns and strategies</li>
        </ul>
    </div>

    <h2>ðŸŽ¯ Try It Yourself!</h2>
    
    <div class="success-box">
        <strong>Challenge:</strong> Open your browser's Network tab and compare response times:
        <ol>
            <li>Call <code>/cachelearn/demo/complex</code> for the first time (slow)</li>
            <li>Call it again within 5 minutes (fast!)</li>
            <li>Clear cache and call it again (slow again)</li>
        </ol>
        <p>This is the power of caching! ðŸš€</p>
    </div>
</div>

