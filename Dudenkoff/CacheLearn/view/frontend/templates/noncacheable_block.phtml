<?php
/**
 * @var \Dudenkoff\CacheLearn\Block\NonCacheableBlock $block
 */
?>
<style>
.cache-demo { max-width: 1200px; margin: 20px auto; font-family: Arial, sans-serif; }
.block-container { border: 3px solid #f44336; background: #ffebee; padding: 20px; margin: 20px 0; border-radius: 8px; }
.block-container h2 { margin-top: 0; color: #c62828; }
.info-box { background: white; padding: 15px; margin: 10px 0; border-radius: 4px; border-left: 4px solid #f44336; }
.time-display { font-size: 32px; font-weight: bold; color: #d32f2f; padding: 15px; background: #fff; border-radius: 4px; text-align: center; }
.file-list { background: #263238; color: #aed581; padding: 15px; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
.command-box { background: #37474f; color: #4fc3f7; padding: 15px; border-radius: 4px; font-family: monospace; margin: 10px 0; }
ul { line-height: 1.8; }
</style>

<div class="cache-demo">
    <div class="block-container">
        <h2>üî¥ NON-CACHEABLE BLOCK</h2>
        
        <div class="info-box">
            <p><strong>Settings:</strong></p>
            <ul>
                <li><code>cacheable="false"</code></li>
                <li><code>class="Dudenkoff\CacheLearn\Block\NonCacheableBlock"</code></li>
            </ul>
        </div>
        
        <div class="time-display">
            Current Time: <?= $escaper->escapeHtml($block->getCurrentTime()) ?>
        </div>
        
        <div class="info-box">
            <p><strong>‚úÖ What's Happening:</strong></p>
            <ul>
                <li>This block is <strong>regenerated on EVERY request</strong></li>
                <li>The timestamp above <strong>updates every time</strong> you refresh</li>
                <li>No HTML is cached</li>
                <li>Page must be <code>cacheable="false"</code> too, or FPC will cache the whole page</li>
            </ul>
        </div>
        
        <div class="info-box">
            <p><strong>üìÅ Page Cache Files (FPC):</strong></p>
            <div class="file-list">
<?php 
$files = $block->getPageCacheFiles();
if (empty($files)): ?>
                No Full Page Cache files found (correct - page is not cacheable)
<?php else: 
    foreach (array_slice($files, 0, 5) as $file): 
        $cacheInfo = $block->getCacheInfo();
?>
                <?= $escaper->escapeHtml(basename($file)) ?>
                Size: <?= $escaper->escapeHtml($cacheInfo->getFileSize($file)) ?>
                Modified: <?= $escaper->escapeHtml($cacheInfo->getFileModTime($file)) ?>
                
<?php 
    endforeach;
    if (count($files) > 5): ?>
                ... and <?= count($files) - 5 ?> more files
<?php endif;
endif; ?>
            </div>
        </div>
        
        <div class="info-box">
            <p><strong>üîß CLI Commands:</strong></p>
            <div class="command-box">
# View page cache files
find var/page_cache -name "mage---*" -type f | head -5

# Clear page cache
rm -rf var/page_cache/*
bin/magento cache:clean full_page

# Disable FPC for development
bin/magento cache:disable full_page
            </div>
        </div>
    </div>
</div>

